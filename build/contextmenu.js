define("kg/editor-plugins/1.2.0/contextmenu",["editor","menu","./focus-fix","event-dom","node"],function(e,n,t){var o=e("editor"),d=e("menu"),i=e("./focus-fix"),u=e("event-dom"),c=e("node");o.prototype.addContextMenu=function(e,n,t){function f(e){var n=c(e.target),t=e.pageX,d=e.pageY;if(t){var i=o.Utils.getXY({left:t,top:d},r);t=i.left,d=i.top,setTimeout(function(){s.set("editorSelectedEl",n,{silent:1}),s.move(t,d),r.fire("contextmenu",{contextmenu:s}),s.show(),window.focus(),document.body.focus(),s.focus()},30)}}var r=this;t=t||{};var a=t.event;a&&delete t.event,t.prefixCls=r.get("prefixCls")+"editor-",t.editor=r,t.focusable=1,t.zIndex=o.baseZIndex(o.ZIndexManager.POPUP_MENU);var s=new d.PopupMenu(t);return i.init(s),s.on("afterRenderUI",function(){s.get("el").on("keydown",function(e){e.keyCode===u.KeyCode.ESC&&s.hide()})}),r.docReady(function(){var e=r.get("document");e.on("mousedown",function(e){1===e.which&&s.hide()}),e.delegate("contextmenu",n,function(e){e.halt(),f(e)})}),a&&f(a),r.addControl(e+"/contextmenu",s),s}});